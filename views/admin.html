% rebase('osnova.html', title='admin')

<body>
    <div class="container my-5">
        <div class="row g-4 justify-content-center">
            <div class="col-12 col-md-8">
                <!-- Dodaj rezultat -->
                <div class="p-4 border rounded-3 bg-white shadow-sm mb-4">
                    <h3 class="mb-4 text-center">Dodaj rezultat</h3>
                    <form action="/add_rezultat" method="post">
                        <div class="mb-3">
                            <label class="form-label">Event:</label>
                            <select name="event_id" class="form-select" required>
                                % for event in eventi:
                                    <option value="{{event[0]}}">{{event[1]}} - {{event[2]}}</option>
                                % end
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Voznik:</label>
                            <input type="text" name="voznik" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Ekipa:</label>
                            <input type="text" name="ekipa" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Mesto:</label>
                            <input type="number" name="mesto" class="form-control">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Čas kroga:</label>
                            <input type="text" name="cas" class="form-control">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Točke:</label>
                            <input type="number" name="tocke" class="form-control">
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-light">Dodaj rezultat</button>
                        </div>
                    </form>
                </div>

                <!-- Dodaj event -->
                <div class="p-4 border rounded-3 bg-white shadow-sm mb-4">
                    <h3 class="mb-4 text-center">Dodaj event</h3>
                    <form action="/add_event" method="post">
                        <div class="mb-3">
                            <label class="form-label">Leto:</label>
                            <input type="number" name="leto" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Država:</label>
                            <select name="drzava" class="form-select" required>
                                % for drzava in drzave:
                                    <option value="{{drzava}}">{{drzava}}</option>
                                % end
                            </select>
                        </div>

                        <div class="text-center">
                            <button type="submit" class="btn btn-light">Dodaj event</button>
                        </div>
                    </form>
                </div>

                <!-- Iskanje in brisanje -->
                <div class="p-4 border rounded-3 bg-white shadow-sm">
                    <h3 class="mb-3 text-center">Iskanje in brisanje</h3>

                    <input type="text" id="searchBox" class="form-control mb-3" placeholder="Išči po imenu..." onkeyup="filterList()">

                    <h5>Vozniki</h5>
                    <ul id="voznikList" class="list-group mb-3">
                        % for voznik in vozniki:
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{voznik[1]}}
                            <a href="/delete_voznik/{{voznik[0]}}/" onclick="return confirm('Izbrišem voznika {{voznik[1]}}?')" class="text-danger">izbriši</a>
                        </li>
                        % end
                    </ul>

                    <h5>Ekipe</h5>
                    <ul id="ekipaList" class="list-group mb-3">
                        % for ekipa in ekipe:
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ekipa[1]}}
                            <a href="/delete_ekipa/{{ekipa[0]}}/" onclick="return confirm('Izbrišem ekipo {{ekipa[1]}}?')" class="text-danger">izbriši</a>
                        </li>
                        % end
                    </ul>

                    <h5>Eventi</h5>
                    <ul id="eventList" class="list-group">
                        % for e in eventi:
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{e[1]}} – {{e[2]}}
                            <a href="/delete_event/{{e[0]}}/" onclick="return confirm('Izbrišem event {{e[0]}}?')" class="text-danger">izbriši</a>
                        </li>
                        % end
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function filterList() {
            let filter = document.getElementById('searchBox').value.toLowerCase();
            let lists = [document.getElementById('voznikList'),
                         document.getElementById('ekipaList'),
                         document.getElementById('eventList')];
            lists.forEach(list => {
                if (list) {
                    let items = list.getElementsByTagName('li');
                    for (let i = 0; i < items.length; i++) {
                        let txt = items[i].innerText.toLowerCase();
                        items[i].style.display = txt.includes(filter) ? "" : "none";
                    }
                }
            });
        }
    </script>
</body>
